<!DOCTYPE html>

<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Sorteo Online</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container { max-width: 1200px; margin: 0 auto; }
        .card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        h1 {
            text-align: center;
            color: #667eea;
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        .status {
            text-align: center;
            color: #10b981;
            font-weight: bold;
            margin-bottom: 20px;
        }
        input[type="text"] {
            width: 100%;
            padding: 15px;
            font-size: 1.1em;
            border: 2px solid #ddd;
            border-radius: 10px;
            margin-bottom: 10px;
        }
        input[type="text"]:focus {
            outline: none;
            border-color: #667eea;
        }
        .btn {
            padding: 15px 30px;
            font-size: 1em;
            font-weight: bold;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }
        .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .btn-primary:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        .btn-green {
            background: #10b981;
            color: white;
        }
        .btn-green:hover:not(:disabled) {
            background: #059669;
        }
        .btn-blue {
            background: #3b82f6;
            color: white;
        }
        .btn-blue:hover:not(:disabled) {
            background: #2563eb;
        }
        .btn-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        .tab {
            flex: 1;
            padding: 15px;
            background: rgba(255,255,255,0.3);
            border: none;
            border-radius: 10px;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        .tab.active {
            background: white;
            color: #667eea;
        }
        .input-group {
            display: flex;
            gap: 10px;
        }
        .participante {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .participante-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f3f4f6;
        }
        .participante-nombre {
            font-size: 1.5em;
            font-weight: bold;
            color: #1f2937;
        }
        .participante-fecha {
            font-size: 0.9em;
            color: #6b7280;
        }
        .btn-delete {
            background: #ef4444;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.2em;
        }
        .btn-delete:hover {
            background: #dc2626;
        }
        .numeros-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
        }
        .numero {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-size: 1.3em;
            font-weight: bold;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }
        .empty-state {
            text-align: center;
            padding: 50px;
            color: #6b7280;
            font-size: 1.2em;
        }
        .historial-item {
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
        }
        .historial-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        .historial-nombre {
            font-size: 1.3em;
            font-weight: bold;
        }
        .historial-info {
            color: #6b7280;
            margin-bottom: 10px;
        }
        .historial-detalles {
            background: #f9fafb;
            padding: 15px;
            border-radius: 8px;
            margin-top: 10px;
        }
        .historial-participante {
            padding: 10px;
            margin-bottom: 10px;
            background: white;
            border-radius: 5px;
        }
        details {
            cursor: pointer;
        }
        summary {
            color: #667eea;
            font-weight: bold;
            padding: 10px;
        }
        summary:hover {
            background: #f3f4f6;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="card">
            <h1>üéüÔ∏è Sistema de Sorteo Online</h1>
            <div class="status">‚úÖ Datos guardados autom√°ticamente</div>
            <input type="text" id="nombreSorteo" placeholder="Nombre del sorteo (opcional)">
        </div>


    <div class="btn-grid">
        <button class="btn btn-green" id="btnArchivar">üì¶ Archivar y Nuevo Sorteo</button>
        <button class="btn btn-blue" id="btnExportar">üíæ Exportar Datos</button>
    </div>

    <div class="tabs">
        <button class="tab active" data-tab="registro">‚ûï Registrar</button>
        <button class="tab" data-tab="buscar">üîç Buscar</button>
        <button class="tab" data-tab="historial">üìö Historial (<span id="historialCount">0</span>)</button>
    </div>

    <div id="vistaRegistro" class="vista">
        <div class="card">
            <h2 style="margin-bottom: 20px;">üë• Nuevo Participante</h2>
            <div class="input-group">
                <input type="text" id="nombreParticipante" placeholder="Nombre del participante">
                <button class="btn btn-primary" id="btnAgregar">Agregar</button>
            </div>
            <p style="margin-top: 15px; color: #6b7280;">Total: <span id="totalParticipantes">0</span> participantes</p>
        </div>
    </div>

    <div id="vistaBuscar" class="vista" style="display: none;">
        <div class="card">
            <h2 style="margin-bottom: 20px;">üîç Buscar Participante</h2>
            <input type="text" id="busqueda" placeholder="Busca por nombre o n√∫mero...">
        </div>
    </div>

    <div id="vistaHistorial" class="vista" style="display: none;">
        <div class="card">
            <h2>üìö Historial de Sorteos</h2>
            <div id="listaHistorial"></div>
        </div>
    </div>

    <div id="listaParticipantes"></div>
</div>

<script>
    let participantes = [];
    let historial = [];
    let nombreSorteo = '';
    let vistaActual = 'registro';

    // Cargar datos al iniciar
    function cargarDatos() {
        const datosGuardados = localStorage.getItem('sorteoActual');
        const historialGuardado = localStorage.getItem('historialSorteos');
        const nombreGuardado = localStorage.getItem('nombreSorteo');
        
        if (datosGuardados) participantes = JSON.parse(datosGuardados);
        if (historialGuardado) historial = JSON.parse(historialGuardado);
        if (nombreGuardado) {
            nombreSorteo = nombreGuardado;
            document.getElementById('nombreSorteo').value = nombreSorteo;
        }
        
        actualizarVista();
    }

    // Guardar datos
    function guardarDatos() {
        localStorage.setItem('sorteoActual', JSON.stringify(participantes));
        localStorage.setItem('historialSorteos', JSON.stringify(historial));
        localStorage.setItem('nombreSorteo', nombreSorteo);
    }

    // Generar n√∫meros aleatorios
    function generarNumeros() {
        const nums = new Set();
        while (nums.size < 10) {
            nums.add(String(Math.floor(Math.random() * 10000)).padStart(4, '0'));
        }
        return Array.from(nums).sort();
    }

    // Agregar participante
    function agregarParticipante() {
        const input = document.getElementById('nombreParticipante');
        const nombre = input.value.trim();
        
        if (!nombre) {
            alert('Por favor ingresa un nombre');
            return;
        }
        
        if (participantes.some(p => p.nombre.toLowerCase() === nombre.toLowerCase())) {
            alert('Este participante ya est√° registrado');
            return;
        }
        
        participantes.push({
            id: Date.now(),
            nombre: nombre,
            numeros: generarNumeros(),
            fecha: new Date().toLocaleString()
        });
        
        input.value = '';
        guardarDatos();
        actualizarVista();
    }

    // Eliminar participante
    function eliminarParticipante(id) {
        if (confirm('¬øEst√°s seguro de eliminar este participante?')) {
            participantes = participantes.filter(p => p.id !== id);
            guardarDatos();
            actualizarVista();
        }
    }

    // Archivar sorteo
    function archivarSorteo() {
        if (participantes.length === 0) {
            alert('No hay participantes para archivar');
            return;
        }
        
        if (!confirm('¬øArchivar el sorteo actual e iniciar uno nuevo?')) return;
        
        const nombre = nombreSorteo || prompt('Nombre del sorteo:', 'Sorteo ' + new Date().toLocaleDateString());
        if (!nombre) return;
        
        historial.unshift({
            id: Date.now(),
            nombre: nombre,
            participantes: [...participantes],
            fecha: new Date().toLocaleString(),
            total: participantes.length
        });
        
        participantes = [];
        nombreSorteo = '';
        document.getElementById('nombreSorteo').value = '';
        
        guardarDatos();
        cambiarVista('registro');
        alert('¬°Sorteo archivado exitosamente!');
    }

    // Exportar datos
    function exportarDatos() {
        if (participantes.length === 0) {
            alert('No hay participantes para exportar');
            return;
        }
        
        let texto = `‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n`;
        texto += `SORTEO: ${nombreSorteo || 'Actual'}\n`;
        texto += `‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n`;
        texto += `Fecha: ${new Date().toLocaleString()}\n`;
        texto += `Total: ${participantes.length} participantes\n\n`;
        
        participantes.forEach((p, i) => {
            texto += `${i + 1}. ${p.nombre}\n`;
            texto += `   N√∫meros: ${p.numeros.join(' - ')}\n\n`;
        });
        
        const blob = new Blob([texto], { type: 'text/plain' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `sorteo-${Date.now()}.txt`;
        a.click();
        URL.revokeObjectURL(url);
    }

    // Cambiar vista
    function cambiarVista(vista) {
        vistaActual = vista;
        
        document.querySelectorAll('.vista').forEach(v => v.style.display = 'none');
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        
        document.getElementById(`vista${vista.charAt(0).toUpperCase() + vista.slice(1)}`).style.display = 'block';
        document.querySelector(`[data-tab="${vista}"]`).classList.add('active');
        
        actualizarVista();
    }

    // Actualizar vista
    function actualizarVista() {
        document.getElementById('totalParticipantes').textContent = participantes.length;
        document.getElementById('historialCount').textContent = historial.length;
        
        const btnArchivar = document.getElementById('btnArchivar');
        const btnExportar = document.getElementById('btnExportar');
        btnArchivar.disabled = participantes.length === 0;
        btnExportar.disabled = participantes.length === 0;
        
        if (vistaActual === 'historial') {
            mostrarHistorial();
        } else {
            mostrarParticipantes();
        }
    }

    // Mostrar participantes
    function mostrarParticipantes() {
        const busqueda = document.getElementById('busqueda').value.toLowerCase();
        const filtrados = participantes.filter(p => 
            p.nombre.toLowerCase().includes(busqueda) ||
            p.numeros.some(n => n.includes(busqueda))
        );
        
        const lista = document.getElementById('listaParticipantes');
        
        if (filtrados.length === 0) {
            lista.innerHTML = '<div class="card empty-state">No hay participantes</div>';
            return;
        }
        
        lista.innerHTML = filtrados.map(p => `
            <div class="participante">
                <div class="participante-header">
                    <div>
                        <div class="participante-nombre">${p.nombre}</div>
                        <div class="participante-fecha">Registrado: ${p.fecha}</div>
                    </div>
                    <button class="btn-delete" onclick="eliminarParticipante(${p.id})">üóëÔ∏è</button>
                </div>
                <div>
                    <p style="font-weight: bold; margin-bottom: 10px;">N√∫meros asignados:</p>
                    <div class="numeros-grid">
                        ${p.numeros.map(n => `<div class="numero">${n}</div>`).join('')}
                    </div>
                </div>
            </div>
        `).join('');
    }

    // Mostrar historial
    function mostrarHistorial() {
        const lista = document.getElementById('listaHistorial');
        
        if (historial.length === 0) {
            lista.innerHTML = '<div class="empty-state">No hay sorteos archivados</div>';
            return;
        }
        
        lista.innerHTML = historial.map(s => `
            <div class="historial-item">
                <div class="historial-header">
                    <div>
                        <div class="historial-nombre">${s.nombre}</div>
                        <div class="historial-info">${s.fecha} ‚Ä¢ ${s.total} participantes</div>
                    </div>
                </div>
                <details>
                    <summary>Ver participantes</summary>
                    <div class="historial-detalles">
                        ${s.participantes.map(p => `
                            <div class="historial-participante">
                                <strong>${p.nombre}</strong><br>
                                <small>${p.numeros.join(' - ')}</small>
                            </div>
                        `).join('')}
                    </div>
                </details>
            </div>
        `).join('');
    }

    // Event listeners
    document.getElementById('btnAgregar').addEventListener('click', agregarParticipante);
    document.getElementById('nombreParticipante').addEventListener('keypress', (e) => {
        if (e.key === 'Enter') agregarParticipante();
    });
    document.getElementById('btnArchivar').addEventListener('click', archivarSorteo);
    document.getElementById('btnExportar').addEventListener('click', exportarDatos);
    document.getElementById('nombreSorteo').addEventListener('input', (e) => {
        nombreSorteo = e.target.value;
        guardarDatos();
    });
    document.getElementById('busqueda').addEventListener('input', actualizarVista);
    
    document.querySelectorAll('.tab').forEach(tab => {
        tab.addEventListener('click', () => cambiarVista(tab.dataset.tab));
    });

    // Inicializar
    cargarDatos();
</script>


</body>
</html>
